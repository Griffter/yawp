<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>YAWP! by feroult</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">YAWP!</h1>
      <h2 class="project-tagline">Unbelievably Simple DSL for Google App Engine (Java)</h2>
      <a href="https://github.com/feroult/yawp" class="btn">View on GitHub</a>
      <a href="https://github.com/feroult/yawp/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/feroult/yawp/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h2>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span class="octicon octicon-link"></span></a>Introduction</h2>

<p><strong>YAWP!</strong> is a Java framework built on top of Google App Engine whose main purpose is to help developers create meaningful APIs to support their REST based applications.</p>

<p>You create your POJOs and <strong>YAWP!</strong> </p>

<h2>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Installation</h2>

<h4>
<a id="maven-archetype" class="anchor" href="#maven-archetype" aria-hidden="true"><span class="octicon octicon-link"></span></a>Maven Archetype</h4>

<div class="highlight highlight-bash"><pre>mvn archetype:generate \
  -DarchetypeGroupId=io.yawp \
  -DarchetypeArtifactId=yawp \
  -DarchetypeVersion=1.0 \
  -DgroupId=<span class="pl-k">&lt;</span>your groupId<span class="pl-k">&gt;</span> \
  -DartifactId=<span class="pl-k">&lt;</span>your artifactId<span class="pl-k">&gt;</span> \
  -Dversion=<span class="pl-k">&lt;</span>your version<span class="pl-k">&gt;</span></pre></div>

<p>From the generated app folder run:</p>

<pre><code>mvn appengine:devserver
</code></pre>

<p>Point your browser to <a href="http://localhost:8080/test/all.html">http://localhost:8080/test/all.html</a> to run the default test suite.</p>

<h4>
<a id="maven-dependency" class="anchor" href="#maven-dependency" aria-hidden="true"><span class="octicon octicon-link"></span></a>Maven Dependency</h4>

<p>If you prefer to configure it manually, use this maven dependency: </p>

<div class="highlight highlight-xml"><pre>&lt;<span class="pl-ent">dependency</span>&gt;
   &lt;<span class="pl-ent">groupId</span>&gt;io.yawp&lt;/<span class="pl-ent">groupId</span>&gt;
   &lt;<span class="pl-ent">artifactId</span>&gt;yawp&lt;/<span class="pl-ent">artifactId</span>&gt;
   &lt;<span class="pl-ent">version</span>&gt;1.0&lt;/<span class="pl-ent">version</span>&gt;
&lt;/<span class="pl-ent">dependency</span>&gt;</pre></div>

<p>Then configure the other App Engine's stuff. You can get inspiration from this <a href="https://cloud.google.com/appengine/docs/java/gettingstarted/creating">guide</a>.</p>

<h2>
<a id="how-it-works" class="anchor" href="#how-it-works" aria-hidden="true"><span class="octicon octicon-link"></span></a>How it Works</h2>

<p>From a single class annotation, it provides a full REST url schema with a fluent progamatic API for Java and Javascript. You write your client side code the same way you do for your server side. It also provides a convenient way to organize your server side business logic.</p>

<h3>
<a id="rest-schema" class="anchor" href="#rest-schema" aria-hidden="true"><span class="octicon octicon-link"></span></a>REST Schema</h3>

<p>Annotate your POJO:</p>

<div class="highlight highlight-java"><pre>@Endpoint(path <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>/people<span class="pl-pds">"</span></span>)
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Person</span> {

    <span class="pl-k">private</span> <span class="pl-smi">String</span> name;

}</pre></div>

<p>Then use one of HTTP, Java or Javascript APIs to access your resources:</p>

<p><strong>HTTP</strong>:</p>

<table>
<thead>
<tr>
<th>Verb</th>
<th>Path</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>GET</td>
<td>/people</td>
<td>List people</td>
</tr>
<tr>
<td>POST</td>
<td>/people</td>
<td>Create a person</td>
</tr>
<tr>
<td>GET</td>
<td>/people/{id}</td>
<td>Show a person</td>
</tr>
<tr>
<td>PUT/PATCH</td>
<td>/people/{id}</td>
<td>Update a person</td>
</tr>
<tr>
<td>DELETE</td>
<td>/people/{id}</td>
<td>Destroy a person</td>
</tr>
</tbody>
</table>

<p><strong>Javascript</strong>:</p>

<div class="highlight highlight-javascript"><pre>yawp(<span class="pl-s"><span class="pl-pds">'</span>/people<span class="pl-pds">'</span></span>).list( <span class="pl-k">function</span>(<span class="pl-smi">people</span>) {} );

yawp(<span class="pl-s"><span class="pl-pds">'</span>/people<span class="pl-pds">'</span></span>).create({ name <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>Janes<span class="pl-pds">'</span></span> }).done( <span class="pl-k">function</span>(<span class="pl-smi">person</span>) {} );

yawp(personId).fetch( <span class="pl-k">function</span>(<span class="pl-smi">person</span>) {} );

yawp.update(person).done( <span class="pl-k">function</span>(<span class="pl-smi">person</span>) {} );

yawp.destroy(personId).done( <span class="pl-k">function</span>(<span class="pl-smi">personId</span>) {} );</pre></div>

<p><strong>Java</strong>:</p>

<div class="highlight highlight-java"><pre><span class="pl-k">List&lt;<span class="pl-smi">Person</span>&gt;</span> people <span class="pl-k">=</span> yawp(<span class="pl-smi">Person</span><span class="pl-k">.</span>class)<span class="pl-k">.</span>list();

yawp<span class="pl-k">.</span>save(<span class="pl-k">new</span> <span class="pl-smi">Person</span>(<span class="pl-s"><span class="pl-pds">"</span>Janes<span class="pl-pds">"</span></span>));

<span class="pl-smi">Person</span> person <span class="pl-k">=</span> yawp(<span class="pl-smi">Person</span><span class="pl-k">.</span>class)<span class="pl-k">.</span>fetch(personId);

yawp<span class="pl-k">.</span>save(person);

yawp<span class="pl-k">.</span>destroy(person<span class="pl-k">.</span>getId());</pre></div>

<h3>
<a id="idref" class="anchor" href="#idref" aria-hidden="true"><span class="octicon octicon-link"></span></a>IdRef</h3>

<p>The IdRef&lt;T&gt; brings a bit of innovation inside your POJOs. This class simplifies all underlying manipulation of Datastore Key mechanism and creates a type safe link beetween all your domain objects. </p>

<p>To define the identity field of a domain object you need to declare an IdRef&lt;T&gt; annotated with <a href="https://github.com/Id" class="user-mention">@Id</a>. Then you can use this identity as a reference from another domain object.</p>

<p>Also, through the @ParentId annotation, IdRef exposes the Ancestor mechanism of the Datastore Key architecuture, leveraging it's strong consistency model when necessary:</p>

<div class="highlight highlight-java"><pre>@Endpoint(path <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>/people<span class="pl-pds">"</span></span>)
<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Person</span> {

    <span class="pl-k">@Id</span>
    <span class="pl-k">private</span> <span class="pl-k">IdRef&lt;<span class="pl-smi">Person</span>&gt;</span> id;

    <span class="pl-k">@ParentId</span>
    <span class="pl-k">private</span> <span class="pl-k">IdRef&lt;<span class="pl-smi">Company</span>&gt;</span> companyId;

    <span class="pl-k">private</span> <span class="pl-k">IdRef&lt;<span class="pl-smi">Address</span>&gt;</span> addressId;

    <span class="pl-k">private</span> <span class="pl-smi">String</span> name;

}</pre></div>

<p>Note: All <strong>YAWP!</strong> POJOs must have one and only one IdRef attribute annotated with <a href="https://github.com/Id" class="user-mention">@Id</a></p>

<h3>
<a id="query-api" class="anchor" href="#query-api" aria-hidden="true"><span class="octicon octicon-link"></span></a>Query API</h3>

<p>From a HTTP call, a Java or Javascript method you can query your objects using a fluent API that nicely exposes the  Datastore Query class.</p>

<p><strong>Javascript</strong>:</p>

<div class="highlight highlight-javascript"><pre>yawp(<span class="pl-s"><span class="pl-pds">'</span>/people<span class="pl-pds">'</span></span>).where([ <span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>=<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Janes<span class="pl-pds">'</span></span>]).first( <span class="pl-k">function</span>(<span class="pl-smi">person</span>) {} );

yawp(<span class="pl-s"><span class="pl-pds">'</span>/people<span class="pl-pds">'</span></span>).order([ { p<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>name<span class="pl-pds">'</span></span>, d<span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">'</span>desc<span class="pl-pds">'</span></span> } ]).list( <span class="pl-k">function</span>(<span class="pl-smi">people</span>) {} ); 

yawp(<span class="pl-s"><span class="pl-pds">'</span>/people<span class="pl-pds">'</span></span>).from(parentId).list( <span class="pl-k">function</span>(<span class="pl-smi">people</span>) {} ); </pre></div>

<p><strong>Java</strong>:</p>

<div class="highlight highlight-java"><pre><span class="pl-smi">Person</span> person <span class="pl-k">=</span> yawp(<span class="pl-smi">Person</span><span class="pl-k">.</span>class)<span class="pl-k">.</span>where(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>=<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Janes<span class="pl-pds">"</span></span>)<span class="pl-k">.</span>first();

<span class="pl-k">List&lt;<span class="pl-smi">Person</span>&gt;</span> people <span class="pl-k">=</span> yawp(<span class="pl-smi">Person</span><span class="pl-k">.</span>class)<span class="pl-k">.</span>order(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>desc<span class="pl-pds">"</span></span>)<span class="pl-k">.</span>list(); 

<span class="pl-k">List&lt;<span class="pl-smi">Person</span>&gt;</span> people <span class="pl-k">=</span> yawp(<span class="pl-smi">Person</span><span class="pl-k">.</span>class)<span class="pl-k">.</span>from(parentId)<span class="pl-k">.</span>list(); </pre></div>

<p>Other Java examples, also avaibale from HTTP or Javascript:</p>

<div class="highlight highlight-java"><pre>yawp(<span class="pl-smi">User</span><span class="pl-k">.</span>class)<span class="pl-k">.</span>where(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>=<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>Mark<span class="pl-pds">"</span></span>)<span class="pl-k">.</span>and(<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>&gt;=<span class="pl-pds">"</span></span>, <span class="pl-c1">21</span>)<span class="pl-k">.</span>list();

yawp(<span class="pl-smi">User</span><span class="pl-k">.</span>class)<span class="pl-k">.</span>where(or(and(c(<span class="pl-s"><span class="pl-pds">"</span>company<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>=<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>github.com<span class="pl-pds">"</span></span>), c(<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>&gt;=<span class="pl-pds">"</span></span>, <span class="pl-c1">21</span>)), and(c(<span class="pl-s"><span class="pl-pds">"</span>company<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>=<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>YAWP!<span class="pl-pds">"</span></span>), c(<span class="pl-s"><span class="pl-pds">"</span>age<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>&gt;=<span class="pl-pds">"</span></span>, <span class="pl-c1">18</span>))))<span class="pl-k">.</span>ids();

yawp(<span class="pl-smi">User</span><span class="pl-k">.</span>class)<span class="pl-k">.</span>where(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>=<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>John<span class="pl-pds">"</span></span>)<span class="pl-k">.</span>and(<span class="pl-s"><span class="pl-pds">"</span>company<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>=<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>github.com<span class="pl-pds">"</span></span>)<span class="pl-k">.</span>only();</pre></div>

<p>Note: The methods <strong>c</strong>, <strong>and</strong> and <strong>or</strong> must be imported static or fully qualified for this to work.</p>

<p>You can look at this <a href="../master/src/test/java/io/yawp/repository/query/DatastoreQueryTest.java">Java test suite</a> to see examples of more complex constructions.</p>

<h3>
<a id="endpoint-features" class="anchor" href="#endpoint-features" aria-hidden="true"><span class="octicon octicon-link"></span></a>Endpoint Features</h3>

<p>So far, you've seen all functionality that you get by just annotating your POJO with <a href="https://github.com/Endpoint" class="user-mention">@Endpoint</a>. Now it's time to see how to add custom server side business logic to your model, so you can create real world applications with specific needs.</p>

<p>The way <strong>YAWP!</strong> deal with this is by allowing you to extend the default REST schema through <strong>Features</strong>. You can create three kind of features for your objects: <strong>Actions</strong>, <strong>Transformers</strong> and <strong>Hooks</strong>. </p>

<h3>
<a id="actions" class="anchor" href="#actions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Actions</h3>

<p>To add custom behavior to your domain object you can use the Action API. Imagine you need to activate a given person. To do this you can create an Action class:</p>

<div class="highlight highlight-java"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">ActivatePersonAction</span> <span class="pl-k">extends</span> <span class="pl-e">Action&lt;<span class="pl-smi">Person</span>&gt;</span> {

    <span class="pl-k">@PUT</span>(<span class="pl-s"><span class="pl-pds">"</span>active<span class="pl-pds">"</span></span>)
    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">activate</span>(<span class="pl-k">IdRef&lt;<span class="pl-smi">Person</span>&gt;</span> <span class="pl-v">id</span>) {
        <span class="pl-smi">Person</span> person <span class="pl-k">=</span> id<span class="pl-k">.</span>fetch();
        person<span class="pl-k">.</span>setActive(<span class="pl-c1">true</span>);
        yawp<span class="pl-k">.</span>save(person);
    }

}</pre></div>

<p>Now, to activate a given person, let's say, with id 123, you can:</p>

<pre>
curl -X <b>PUT</b> http://localhost:8080/api<b>/people/123/active</b>
</pre>

<p>The <strong>Javascript</strong> equivalent would be:</p>

<div class="highlight highlight-javascript"><pre>yawp(<span class="pl-s"><span class="pl-pds">'</span>/people/123<span class="pl-pds">'</span></span>).put(<span class="pl-s"><span class="pl-pds">'</span>active<span class="pl-pds">'</span></span>).done( <span class="pl-k">function</span>(<span class="pl-smi">status</span>) {} );</pre></div>

<p>Also, an action be called over a single domain object or over a collection. For an action over a collection, don't specify it's IdRef or specify it's parent IdRef as the first argument:</p>

<div class="highlight highlight-java"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">UserActions</span> <span class="pl-k">extends</span> <span class="pl-e">Action&lt;<span class="pl-smi">User</span>&gt;</span> {
    <span class="pl-c">// over collection without IdRef</span>
    <span class="pl-k">@GET</span>(<span class="pl-s"><span class="pl-pds">"</span>me<span class="pl-pds">"</span></span>)
    <span class="pl-k">public</span> <span class="pl-smi">User</span> <span class="pl-en">me</span>() {
        <span class="pl-k">return</span> <span class="pl-smi">Session</span><span class="pl-k">.</span>getLoggedUser();
    }

    <span class="pl-c">// over collection with parent IdRef</span>
    <span class="pl-k">@GET</span>(<span class="pl-s"><span class="pl-pds">"</span>first<span class="pl-pds">"</span></span>)
    <span class="pl-k">public</span> <span class="pl-smi">User</span> <span class="pl-en">firstUser</span>(<span class="pl-k">IdRef&lt;<span class="pl-smi">Company</span>&gt;</span> <span class="pl-v">companyId</span>) {
      <span class="pl-k">return</span> yawp(<span class="pl-smi">User</span><span class="pl-k">.</span>class)<span class="pl-k">.</span>where(<span class="pl-s"><span class="pl-pds">"</span>companyId<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>=<span class="pl-pds">"</span></span>, companyId)<span class="pl-k">.</span>first();
    }
}</pre></div>

<p>The following routes will be created and mapped to your methods:</p>

<ul>
<li>GET /users/me -&gt; call the action me()</li>
<li>GET /company/{companyId}/users/firstChild -&gt; call the action firstUser()</li>
</ul>

<h3>
<a id="transformers" class="anchor" href="#transformers" aria-hidden="true"><span class="octicon octicon-link"></span></a>Transformers</h3>

<p>The Transformer API is used to create different views of the same domain object. If you wan't to add or hide information to be returned to the client, the way to go is to use a Transfomer. For instance:</p>

<div class="highlight highlight-java"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">BasicObjectTransformer</span> <span class="pl-k">extends</span> <span class="pl-e">Transformer&lt;<span class="pl-smi">Person</span>&gt;</span> {

    <span class="pl-k">public</span> <span class="pl-k">Map&lt;<span class="pl-smi">String</span>, <span class="pl-smi">Object</span>&gt;</span> <span class="pl-en">upperCase</span>(<span class="pl-smi">Person</span> <span class="pl-v">person</span>) {

        <span class="pl-k">Map&lt;<span class="pl-smi">String</span>, <span class="pl-smi">Object</span>&gt;</span> map <span class="pl-k">=</span> asMap(person);
        map<span class="pl-k">.</span>put(<span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span>, person<span class="pl-k">.</span>getName()<span class="pl-k">.</span>toUpperCase());
        <span class="pl-k">return</span> map;

    }

}</pre></div>

<p>Now, to transform a given person, let's say, with id 123, you can:</p>

<pre>
curl -X <b>GET</b> http://localhost:8080/api<b>/people/123?t=upperCase</b>
</pre>

<p>The <strong>Javascript</strong> equivalent would be:</p>

<div class="highlight highlight-javascript"><pre>yawp(<span class="pl-s"><span class="pl-pds">'</span>/people/123<span class="pl-pds">'</span></span>).transform(<span class="pl-s"><span class="pl-pds">'</span>upperCase<span class="pl-pds">'</span></span>).first( <span class="pl-k">function</span>(<span class="pl-smi">person</span>) {} );</pre></div>

<p>Note: All transformers can be applied for collections queries or feching single objects.</p>

<p>You can also create more sofisticated transformers using the presenter pattern, like this:</p>

<div class="highlight highlight-java"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">UserTransformer</span> <span class="pl-k">extends</span> <span class="pl-e">Transformer&lt;<span class="pl-smi">User</span>&gt;</span> {

   <span class="pl-k">public</span> <span class="pl-k">static</span> <span class="pl-k">class</span> <span class="pl-en">UserView</span> {
        <span class="pl-k">private</span> <span class="pl-smi">String</span> name;
        <span class="pl-k">private</span> <span class="pl-smi">String</span> company;
        <span class="pl-k">private</span> <span class="pl-k">int</span> birthYear;

        <span class="pl-k">public</span> <span class="pl-en">UserView</span>(<span class="pl-smi">User</span> <span class="pl-v">user</span>) {
            <span class="pl-v">this</span><span class="pl-k">.</span>name <span class="pl-k">=</span> user<span class="pl-k">.</span>getName();
            <span class="pl-v">this</span><span class="pl-k">.</span>company <span class="pl-k">=</span> user<span class="pl-k">.</span>getCompany();
            <span class="pl-v">this</span><span class="pl-k">.</span>birthYear <span class="pl-k">=</span> <span class="pl-smi">Calendar</span><span class="pl-k">.</span>getInstance()<span class="pl-k">.</span>get(<span class="pl-smi">Calendar</span><span class="pl-c1"><span class="pl-k">.</span>YEAR</span>) <span class="pl-k">-</span> user<span class="pl-k">.</span>getAge();
        }
    }

    <span class="pl-k">public</span> <span class="pl-smi">UserView</span> <span class="pl-en">withYear</span>(<span class="pl-smi">User</span> <span class="pl-v">user</span>) {
        <span class="pl-k">return</span> <span class="pl-k">new</span> <span class="pl-smi">UserView</span>(user);
    }
}</pre></div>

<h3>
<a id="hooks" class="anchor" href="#hooks" aria-hidden="true"><span class="octicon octicon-link"></span></a>Hooks</h3>

<p>Hooks are portions of business logic that are executed before or after a particular action in the system. They can be used to set pre-calculated information on a domain object or to deny access to some users on certain actions. For example, take a look at this Hook:</p>

<div class="highlight highlight-java"><pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">UserHook</span> <span class="pl-k">extends</span> <span class="pl-e">Hook&lt;<span class="pl-smi">User</span>&gt;</span> {

    <span class="pl-k">@Override</span>
    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">beforeQuery</span>(<span class="pl-k">DatastoreQuery&lt;<span class="pl-smi">User</span>&gt;</span> <span class="pl-v">q</span>) {
        q<span class="pl-k">.</span>where(<span class="pl-s"><span class="pl-pds">"</span>company<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>=<span class="pl-pds">"</span></span>, <span class="pl-smi">Session</span><span class="pl-k">.</span>getLoggedUser()<span class="pl-k">.</span>getCompany());
    }

    <span class="pl-k">@Override</span>
    <span class="pl-k">public</span> <span class="pl-k">void</span> <span class="pl-en">beforeSave</span>(<span class="pl-smi">User</span> <span class="pl-v">user</span>) {
        <span class="pl-k">if</span> (user<span class="pl-k">.</span>getAge() <span class="pl-k">&lt;</span> <span class="pl-c1">18</span>) {
            <span class="pl-k">throw</span> <span class="pl-k">new</span> <span class="pl-smi">HttpException</span>(<span class="pl-c1">422</span>, <span class="pl-s"><span class="pl-pds">"</span>You must be 18 or more to sign up.<span class="pl-pds">"</span></span>);
        }
    }
}</pre></div>

<p>You can define 3 Hook types for your application:</p>

<ul>
<li>beforeQuery : called before any query made via a URL. It can be used to add security or default validations;</li>
<li>beforeSave : called before an object is saved. It can be used to pre-calculate or cache some values in the entity, as well as make validations before saving;</li>
<li>afterSave : called after an object is saved. It can be used to trigger actions or log events.</li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/feroult/yawp">YAWP!</a> is maintained by <a href="https://github.com/feroult">feroult</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-54832827-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>

